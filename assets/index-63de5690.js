import{x as U,d as $,I as H,f as k,p as N,N as A,ae as F,r as c,o as i,e as y,z as h,A as C,c as f,B as _,G as T,a as m,w as V,a4 as z,a9 as G,L as D,O as Y,a2 as q,M as J,ah as O,m as K}from"./index-a2b9888c.js";import{a as Q,f as R,c as W,d as X,e as Z,b as x,M as ee}from"./use-overflow-ce853a25.js";import{h as se,l as M,k as oe}from"./index-02a6652d.js";const te=$({name:"Message",components:{AIconHover:Q,IconInfoCircleFill:R,IconCheckCircleFill:W,IconExclamationCircleFill:X,IconCloseCircleFill:Z,IconClose:x,IconLoading:H},props:{type:{type:String,default:"info"},closable:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!0},duration:{type:Number,default:3e3},resetOnUpdate:{type:Boolean,default:!1},resetOnHover:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:s}){const o=k("message");let r=0;const l=()=>{s("close")},t=()=>{e.duration>0&&(r=window.setTimeout(l,e.duration))},n=()=>{r&&(window.clearTimeout(r),r=0)};return N(()=>{t()}),A(()=>{e.resetOnUpdate&&(n(),t())}),F(()=>{n()}),{handleMouseEnter:()=>{e.resetOnHover&&n()},handleMouseLeave:()=>{e.resetOnHover&&t()},prefixCls:o,handleClose:l}}});function ne(e,s,o,r,l,t){const n=c("icon-info-circle-fill"),a=c("icon-check-circle-fill"),u=c("icon-exclamation-circle-fill"),E=c("icon-close-circle-fill"),j=c("icon-loading"),B=c("icon-close"),L=c("a-icon-hover");return i(),y("li",{role:"alert",class:h([e.prefixCls,`${e.prefixCls}-${e.type}`,{[`${e.prefixCls}-closable`]:e.closable}]),onMouseenter:s[1]||(s[1]=(...p)=>e.handleMouseEnter&&e.handleMouseEnter(...p)),onMouseleave:s[2]||(s[2]=(...p)=>e.handleMouseLeave&&e.handleMouseLeave(...p))},[e.showIcon&&!(e.type==="normal"&&!e.$slots.icon)?(i(),y("span",{key:0,class:h(`${e.prefixCls}-icon`)},[C(e.$slots,"icon",{},()=>[e.type==="info"?(i(),f(n,{key:0})):e.type==="success"?(i(),f(a,{key:1})):e.type==="warning"?(i(),f(u,{key:2})):e.type==="error"?(i(),f(E,{key:3})):e.type==="loading"?(i(),f(j,{key:4})):_("v-if",!0)])],2)):_("v-if",!0),T("span",{class:h(`${e.prefixCls}-content`)},[C(e.$slots,"default")],2),e.closable?(i(),y("span",{key:1,class:h(`${e.prefixCls}-close-btn`),onClick:s[0]||(s[0]=(...p)=>e.handleClose&&e.handleClose(...p))},[m(L,null,{default:V(()=>[m(B)]),_:1})],2)):_("v-if",!0)],34)}var ae=U(te,[["render",ne]]);function le(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!G(e)}var re=$({name:"MessageList",props:{messages:{type:Array,default:()=>[]},position:{type:String,default:"top"}},emits:["close","afterClose"],setup(e,s){const o=k("message-list"),{zIndex:r}=se("message",{runOnMounted:!0});return()=>{let l;return m(z,{class:[o,`${o}-${e.position}`],name:"fade-message",tag:"ul",style:{zIndex:r.value},onAfterLeave:()=>s.emit("afterClose")},le(l=e.messages.map(t=>{const n={default:M(t.content),icon:M(t.icon)};return m(ae,{key:t.id,type:t.type,duration:t.duration,closable:t.closable,resetOnUpdate:t.resetOnUpdate,resetOnHover:t.resetOnHover,onClose:()=>s.emit("close",t.id)},n)}))?l:{default:()=>[l]})}}}),ie=Object.defineProperty,ce=Object.defineProperties,ue=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable,I=(e,s,o)=>s in e?ie(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o,v=(e,s)=>{for(var o in s||(s={}))de.call(s,o)&&I(e,o,s[o]);if(b)for(var o of b(s))pe.call(s,o)&&I(e,o,s[o]);return e},P=(e,s)=>ce(e,ue(s));class fe{constructor(s,o){this.messageCount=0,this.add=t=>{var n;this.messageCount++;const a=(n=t.id)!=null?n:`__arco_message_${this.messageCount}`;if(this.messageIds.has(a))return this.update(a,t);const u=Y(v({id:a},t));return this.messages.value.push(u),this.messageIds.add(a),{close:()=>this.remove(a)}},this.update=(t,n)=>{for(let a=0;a<this.messages.value.length;a++)if(this.messages.value[a].id===t){const u=!q(n.duration);Object.assign(this.messages.value[a],P(v({},n),{id:t,resetOnUpdate:u}));break}return{close:()=>this.remove(t)}},this.remove=t=>{for(let n=0;n<this.messages.value.length;n++){const a=this.messages.value[n];if(a.id===t){J(a.onClose)&&a.onClose(t),this.messages.value.splice(n,1),this.messageIds.delete(t);break}}},this.clear=()=>{this.messages.value.splice(0)},this.destroy=()=>{this.messages.value.length===0&&this.container&&(O(null,this.container),document.body.removeChild(this.container),this.container=null,d[this.position]=void 0)};const{position:r="top"}=s;this.container=oe("message"),this.messageIds=new Set,this.messages=K([]),this.position=r;const l=m(re,{messages:this.messages.value,position:r,onClose:this.remove,onAfterClose:this.destroy});(o??w._context)&&(l.appContext=o??w._context),O(l,this.container),document.body.appendChild(this.container)}}const d={},S=[...ee,"loading","normal"],g=S.reduce((e,s)=>(e[s]=(o,r)=>{D(o)&&(o={content:o});const l=v({type:s},o),{position:t="top"}=l;return d[t]||(d[t]=new fe(l,r)),d[t].add(l)},e),{});g.clear=e=>{var s;e?(s=d[e])==null||s.clear():Object.values(d).forEach(o=>o==null?void 0:o.clear())};const w=P(v({},g),{install:e=>{const s={clear:g.clear};for(const o of S)s[o]=(r,l=e._context)=>g[o](r,l);e.config.globalProperties.$message=s},_context:null});export{w as M};
